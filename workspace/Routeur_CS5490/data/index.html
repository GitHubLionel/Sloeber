<!DOCTYPE html>
<html lang="fr-fr">
<head>
  <title>Routeur</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <link rel="stylesheet" href="Routeur.css">
  <link rel="shortcut icon" href="favicon.ico">
</head>
<body>

  <div class="header">
    <span>Routeur</span>
    <span id="time" class="right">12:00:00</span>
  </div>
  <div id="divHeader" style="margin-bottom: 54px;">
    <button class="tablink" onclick="openPage('m_Data', this, 'green')" id="defaultOpen">Données</button>
    <button class="tablink" onclick="openPage('m_Graphe', this, '#FFCB00')">Graphique</button>
    <button class="tablink" onclick="openPage('m_Energy', this, '#C6410D')">Energie</button>
    <button class="tablink" onclick="openPage('m_SSR', this, '#0ee6f0')">SSR</button>
    <button class="tablink" onclick="openPage('m_Config', this, '#cd11e8')">Config</button>

    <button class="tablink" style="cursor:default" onmouseover="this.style.background='black'" > &nbsp; </button>
  </div>

  <noscript>
    <strong>JavaScript est nécessaire ...</strong>
  </noscript>

  <div id="m_Data" class="tabcontent">
    <div class="row">
      <div class="col-1 col-s-1 menu">
        <ul>
          <li><span>Tension : </span><span id="_Urms">230 V</span></li>
        </ul>
      </div>

      <div class="col-1 col-s-1 menu">
        <ul>
          <li><span>Facteur de puissance : </span><span id="_cosphi">1.0</span></li>
        </ul>
      </div>

      <div class="col-2 col-s-3 menu">
      <p> Conso </p>
        <ul>
          <li><span>Puissance :</span><span id="_Conso_P" class="right">0.0 W</span></li>
          <li><span>Energie :</span><span id="_Conso_E" class="right">0.0 Wh</span></li>
          <li><span>Energie surplus :</span><span id="_Conso_S" class="right">0.0 Wh</span></li>
        </ul>
      </div>

      <div class="col-2 col-s-3 menu">
      <p> Température </p>
        <ul>
          <li><span>Cirrus :</span><span id="_T_CS" class="right">25°C</span></li>
          <li><span>DS18B20 interne :</span><span id="_T_DS_int" class="right">25°C</span></li>
          <li><span>DS18B20 externe :</span><span id="_T_DS_ext" class="right">25°C</span></li>
        </ul>
      </div>

    </div>

    <div class="footer">
      <p>.</p>
    </div>
  </div>

  <div id="m_Graphe" class="tabcontent">
    <div class="padCanvas">
      <div id="divCanvas_power">
        <canvas id="can_mean_power"></canvas>
      </div>
      <div class="btnZoom">
        <button class="myButton" onclick="refreshGraph('data')">Actualiser</button>
        <button class="myButton" onclick="undoZoom('can_mean_power')">Dézoomer</button>
        <button class="myButton" title="Exporter dans un fichier texte CSV" onclick="exportCSV('can_mean_power')">==> CSV</button>
        <button class="myButton" title="Exporter dans une image PNG" onclick="exportPNG('can_mean_power', 'puissance.png')">==> PNG</button>
      </div>         
    </div>
  </div>

  <div id="m_Energy" class="tabcontent">
    <div class="padCanvas">
      <div id="divCanvas_energy">
        <canvas id="can_histo_energy"></canvas>
      </div>
      <div class="btnZoom">
        <button class="myButton" onclick="refreshGraph('energy')">Actualiser</button>
        <button class="myButton" onclick="undoZoom('can_histo_energy')">Dézoomer</button>
        <button class="myButton" title="Exporter dans un fichier texte CSV" onclick="exportCSV('can_histo_energy')">==> CSV</button>
        <button class="myButton" title="Exporter dans une image PNG" onclick="exportPNG('can_histo_energy', 'puissance.png')">==> PNG</button>
      </div>         
    </div>
  </div>

  <div id="m_SSR" class="tabcontent">
    <div class="div_space">
      <fieldset>
      <div>
        <input type="radio" id="percent" name="SSRType" value="percent"  onchange="doToggle('SSRType')" checked>
        <label for="percent">Pourcentage</label>
        <input type="radio" id="zero" name="SSRType" value="zero" onchange="doToggle('SSRType')">
        <label for="zero">Zéro</label>
<!--        <button class="myButton" id="select_SSRType" onclick="doToggle('SSRType')">Select</button> -->
      </div>
      <div id="powerCE" style="display: none">
        <label for="powerSSR">Puissance CE : </label>
        <input type="text" name="powerSSR" id="powerSSR" value="1000">
        <label for="targetSSR">Surplus cible : </label>
        <input type="text" name="targetSSR" id="targetSSR" value="0">
        <button class="myButton" id="powerCE" onclick="sendCEPower()">Update</button>
      </div>
      <div id="rangePercent">
      <div class="range" style="--step:10; --min:00; --max:100">
        <input id="Dimmer" type="range" min="00" max="100" step="1" value="10"  oninput="amount.value=Dimmer.value+'%'">
      </div>
      <output id="amount" name="amount" for="Dimmer" style="margin-left: 15px; margin-right: 15px;">10%</output>
      <button class="myButton" onclick="setDimme()">Dimme pourcent</button>
      </div>
      </fieldset>
    </div>
    <div class="div_space">
      <hr>
    </div>
    <div class="div_space">
      <button class="myButton" id="toggle_SSR" onclick="doToggle('SSR')">Toggle SSR</button>
      <label id="label_SSR" for="toggle_SSR">SSR OFF</label>
    </div>
    <div class="div_space">
      <hr>
    </div>
    <div class="div_space">
      <button class="myButton" id="toggle_Relay" onclick="doToggle('Relay')">Toggle Relais</button>
      <label id="label_Relay" for="toggle_Relay">Relais OFF</label>
    </div>
    <div class="div_space">
      <hr>
    </div>
    <div class="div_space">
      <button class="myButton" id="toggle_Keyboard" onclick="doToggle('Keyboard')">Toggle Clavier</button>
      <label id="label_Keyboard" for="toggle_Keyboard">Clavier ON</label>
      <br>
      <span>Données reçues du Clavier : </span>
      <span id="data_keyboard"></span>
    </div>
  </div>

  <div id="m_Config" class="tabcontent">
    <div class="div_space">
      <button class="myButton" onclick="sendDateTime()">Mettre l'heure à jour</button>
    </div>

    <div class="div_space">
      <button class="myButton" onclick="loadLOG()">Télécharger fichier log</button>
      <button class="myButton" onclick="deleteLOG()">Supprimer fichier log</button>
    </div>

    <div class="div_space">
      <form method="GET" action="/delFile">
        <label for="delFile">Fichier à supprimer : </label>
        <input type="text" name="delFile" id="delFile">
        <input class="myButton" type="submit" value="Supprimer">
      </form>
    </div>

    <div class="div_space">
      <button class="myButton" onclick="resetESP()">RESET ESP</button>
    </div>

    <div class="div_space">
      <fieldset>
      <form method="POST" enctype="multipart/form-data" action="/upload">
        <span>ATTENTION : pas d'espace, pas d'accent !</span>
        <br>
          <label for="dir">Dir : </label>
          <input type="text" name="dir" size="30" placeholder="Répertoire destination, vide = /"><br>
        <input type="checkbox" name="reload" checked>
        <label for="reload">Reload page</label>
        <input type="file" name="the_filename">
          <input type="submit" value="Téléverser">
      </form>
        <br>
        <form class="flash" method="GET" enctype="multipart/form-data" action="/firmware">
          <input class="myButton" type="submit" value="Flash ESP">
        </form>
      </fieldset>
    </div>

    <div class="div_space">
      <button class="myButton" onclick="listDir()">List dir</button>
      <br>
      <span id="data_json"></span>
    </div>

    <div class="div_space">
      <span>Données reçues de UART : </span>
      <span id="data_uart"></span>
    </div>

    <div class="div_space">
      <button class="myButton" onclick="doToggle('Oled')">Toggle Oled</button>
    </div>
  </div>

  <!-- Message d'attente -->
  <div class="loader_gif" id="loading"> </div>
<!-- autre alternative pour l'attente
      <div class="loader_txt" id="loading">Chargement ...</div>
-->

  <script type='text/javascript' src="chart.js"></script>
  <script type='text/javascript' src="chartjs-zoom.min.js"></script>
  <script type='text/javascript' src="date-fns.adapter.js"></script>
  <script type='text/javascript' src="FileSaver.min.js"></script>
  <script type='text/javascript' src="CS5490/Page0.js"></script>
  <script type='text/javascript' src="CS5490/Page16.js"></script>
  <script type='text/javascript' src="CS5490/Page17.js"></script>
  <script type='text/javascript' src="CS5490/Page18.js"></script>
  <script type='text/javascript' src="Graphe.js"></script>
  <script type='text/javascript' src="Routeur.js"></script>
</body>
</html>
